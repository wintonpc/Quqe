<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Backtest</title>
  </head>
  <style>
    .line {
      fill: none;
      stroke: steelblue;
      stroke-width: 1.5px;
    }
  </style>
  <body>
   
    <script type="text/javascript" src="js/jquery-1.10.2.min.js"> </script>
    <script type="text/javascript" src="js/d3.v3.min.js"> </script>
    <script type="text/javascript" src="js/knockout-2.3.0.js"> </script>
    <script type="text/javascript" src="js/underscore-min.js"> </script>
    <script type="text/javascript" src="js/pchart.js"> </script>
    
    <div>
      <select data-bind="options: runs, value: selectedRun, optionsText: function(run) { return getRunDescription(run); }"></select>
      <span id="runInfo">
        <span>ProtoRun: </span><span style="font-weight: bold;" data-bind="text: selectedRun().ProtoRun.Name"></span>
        <!--<span>Gens: </span><span style="font-weight: bold;" data-bind="text: selectedRun().Generations.length"></span>-->
      </span>
    </div>

    <svg id="chart" height="400">
      <g id="bars"></g>
    </svg>
    
    <script type="text/javascript">

      var appliedBindings = false;

      var model = {
        runs: ko.observable([]),
        selectedRun: ko.observable(),
        run: ko.observable()
      };

      function getRunDescription(run) {
        return run._id.$oid + " - " + run.ProtoRun.Name + ", " + run.Generations.length + " gens,  ";
      }

      getUri("/quqe/runs", function (runs) {
        model.runs(runs);
        model.selectedRun(model.runs()[0]);
        ko.applyBindings(model);
      });

    </script>
  </body>
</html>